let marketPending=!1;function fetchMarketPrices(e){let t=document.querySelectorAll(nodeNames.market_place);if(t.length>0&&!marketPending){let e=[],n=[];t.forEach(t=>{if(!t.classList.contains(nodeNames.market_place_header)){let a=t.querySelector(nodeNames.market_place_name+" span");if(a){let r=a.innerText;e.push(r),n.push(t)}}}),e.length>0&&(marketPending=!0,sendRequestByName(e).then(t=>{addPricesToMarket(t,e,n),marketPending=!1}).catch(e=>{console.error(e),marketPending=!1}))}}async function sendRequestByName(e){return new Promise(async(t,n)=>{chrome.storage.local.get("user_info",async function(a){let r={name:a.user_info,operation:"fetchPricesByName",extra:e};try{let n=(await makeFetchRequest(apiURL,r)).data,a=e.map(e=>({name:e,price:n[e]}));t(a)}catch(e){n(e)}})})}function addPricesToMarket(e,t,n){e.forEach(e=>{let a=n[t.indexOf(e.name)];if(null!==e.price){let t=a.querySelector(".voxels-market-create-price");if(t){t.innerText=e.price;let n=document.createElement("img");n.src=chrome.runtime.getURL("images/Prices/coin.png"),t.appendChild(n)}else{let t=a.querySelector(nodeNames.market_place_name);if(t){let n=document.createElement("div");n.classList.add("voxels-market-create-price"),n.innerText=e.price;let a=document.createElement("img");a.src=chrome.runtime.getURL("images/Prices/coin.png"),n.appendChild(a),t.appendChild(n)}}}})}