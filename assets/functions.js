let checkInterval,checkHudInterval,imageHashMap,userPremium,inventoryLoaded=!1,inventoryArray=[],imageBlobToNameMap=new Map([[876,"mine"],[791,"coop"],[1210,"hutch"],[832,"apiary"]]);function mainInterval(e,t){let n;let r,a=!1;imageHashMap=t,userPremium=e,checkHudInterval=setInterval(function e(){document.querySelectorAll(nodeNames.hudQuantities).length>0&&(clearInterval(checkHudInterval),loadInventoryPrices(),checkHudInterval=setInterval(()=>{0===document.querySelectorAll(nodeNames.hudQuantities).length?(clearInterval(checkHudInterval),checkHudInterval=setInterval(e,100)):(location.href.endsWith("/gridcraft")||0!==document.querySelectorAll(".voxels-inventory-price").length||loadInventoryPrices(),r=checkForWindow(r,nodeNames.market_place,".voxels-market-create-price",fetchMarketPrices),userPremium&&(a=checkForWindow(a,nodeNames.tasksCard,".voxels-tasks-prices",addTaskPrices),checkInventoryChange(),a&&checkTasks()),(new Date-n)/1e3>=40&&(n=new Date,loadInventoryPrices(),r&&fetchMarketPrices(".voxels-market-create-price"),a&&addTaskPrices(".voxels-tasks-prices"),userPremium&&setTasksCost()))},500),n=new Date)},100)}function checkForWindow(e,t,n,r){let a=document.querySelectorAll(t);return e?0!==a.length&&(0===document.querySelectorAll(n).length&&r(n),!0):a.length>0&&(r(n),!0)}function checkInventoryChange(){let e=getCurrentInventory(!1);if(0===inventoryArray.length||0===e.length){inventoryArray=e;return}let t=compareInventories(inventoryArray,e);!1!==t?(startTimerType(t),inventoryArray=getCurrentInventory(!0)):inventoryArray=e}function getCurrentInventory(e){let t=document.querySelectorAll(nodeNames.hudItems),n=[];return t.forEach(t=>{let r=t.querySelector(nodeNames.hudItemImage),a=t.querySelector(nodeNames.hudQuantities),l=parseInt(t.querySelector(nodeNames.hudShortcut).textContent)-1;if(r&&a&&e)fetch(r.src,{method:"GET"}).then(e=>e.headers.get("Content-Length")).then(e=>{let t=parseInt(a.textContent.replace("x",""))||1;n[l]={length:e,quantity:t}}).catch(e=>console.error("Error fetching blob:",e));else if(a){let e=parseInt(a.textContent.replace("x",""))||1;n[l]={length:null,quantity:e}}else n[l]=null}),n}function compareInventories(e,t){for(let n=0;n<t.length;n++){let r=t[n],a=e[n];if(null!==r&&(null===a&&r.quantity>=1&&r.quantity<=10||null!==a&&r.quantity>a.quantity&&r.quantity<=a.quantity+10)){let e=fetchImageAndCheckContent(n);if(!1!==e)return e}}return!1}function fetchImageAndCheckContent(e){let t=[].slice.call(document.querySelectorAll(nodeNames.hudShortcut)).filter(function(t){return t.innerHTML.trim()===String(e+1)})[0].parentElement.querySelector(nodeNames.hudItemImage);if(t){let e=calculateAverageColor(t);if(imageHashMap[e])return imageHashMap[e]}return!1}function isEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}