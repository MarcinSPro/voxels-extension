let inventoryLoaded=!1,inventoryArray=[],checkInterval;const imageBlobToNameMap=new Map([[876,"mine"],[791,"coop"],[1210,"hutch"],[832,"apiary"]]);function checkHudItem(){let e=document.querySelectorAll(nodeNames.hudQuantities);e.length>0&&(clearInterval(checkInterval),setTimeout(()=>{inventoryLoaded=!0,inventoryArray=getCurrentInventory(!0),document.addEventListener("click",checkClick)},100))}function startChecker(){checkInterval=setInterval(checkHudItem,10)}function checkClick(){if(inventoryLoaded){let e=document.querySelectorAll(nodeNames.hudQuantities);e.length>0&&setTimeout(()=>{let e=getCurrentInventory(!1);if(0===inventoryArray.length||0===e.length){inventoryArray=e;return}compareInventories(inventoryArray,e).then(t=>{!1!==t?(startTimerType(t),inventoryArray=getCurrentInventory(!0)):inventoryArray=e}).catch(e=>{reject(e)})},800)}}function getCurrentInventory(e){let t=document.querySelectorAll(nodeNames.hudItems),n=[];return t.forEach(t=>{let r=t.querySelector(nodeNames.hudItemImage),l=t.querySelector(nodeNames.hudQuantities),o=parseInt(t.querySelector(nodeNames.hudShortcut).textContent)-1;if(r&&l&&e){let c=r.src;fetch(c,{method:"GET"}).then(e=>e.headers.get("Content-Length")).then(e=>{let t=l.textContent.replace("x",""),r=parseInt(t)||1;n[o]={length:e,quantity:r}}).catch(e=>console.error("Error fetching blob:",e))}else if(l){let i=l.textContent.replace("x",""),a=parseInt(i)||1;n[o]={length:null,quantity:a}}else n[o]=null}),n}function compareInventories(e,t){return new Promise(async(n,r)=>{let l=[];console.log(e),console.log(t);for(let o=0;o<t.length;o++){let c=t[o],i=e[o];null!==c&&(null===i&&c.quantity>=1&&c.quantity<=5||null!==i&&c.quantity>i.quantity&&c.quantity<=i.quantity+5)&&l.push(fetchImageAndCheckContent(o))}try{let a=await Promise.all(l),u=a.filter(e=>!1!==e);n(u.length>0&&u[0])}catch(h){r(h)}})}function fetchImageAndCheckContent(e){return new Promise((t,n)=>{let r=[].slice.call(document.querySelectorAll(nodeNames.hudShortcut)).filter(function(t){return t.innerHTML.trim()===String(e+1)}),l=r[0].parentElement,o=l.querySelector(nodeNames.hudItemImage);if(o){let c=o.src;fetch(c,{method:"GET"}).then(e=>e.headers.get("Content-Length")).then(e=>{let n=parseInt(e,10);if(imageBlobToNameMap.has(n)){let r=imageBlobToNameMap.get(n);t(r);return}t(!1)}).catch(e=>{console.error("Error fetching blob:",e),n(e)})}else{t(!1);return}})}function isEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}